syntax "next-router/0.1";

# OpenRouter（OpenAI-compatible）
provider "openrouter" {
  defaults {
    upstream_config {
      base_url = "https://openrouter.ai/api";
    }
    auth {
      auth_bearer;
    }
    metrics {
      usage_extract openai;
    }
    error {
      error_map openai;
    }
    response {
      resp_passthrough;
    }

    # OpenRouter 建议携带来源标识（可选）
    request {
      set_header "HTTP-Referer" "https://github.com/r9s-ai/r9s";
      set_header "X-Title" "r9s";
    }
  }

  match api = "chat.completions" {
    upstream {
      set_path "/v1/chat/completions";
    }
  }
  match api = "completions" {
    upstream {
      set_path "/v1/completions";
    }
  }
  match api = "claude.messages" {
    upstream {
      set_path "/v1/messages";
    }
  }
  match api = "embeddings" {
    upstream {
      set_path "/v1/embeddings";
    }
  }
  match api = "responses" {
    upstream {
      set_path "/v1/responses";
    }
  }
  match api = "images.generations" {
    upstream {
      set_path "/v1/images/generations";
    }
  }
  match api = "audio.speech" {
    upstream {
      set_path "/v1/audio/speech";
    }
  }
  match api = "audio.transcriptions" {
    upstream {
      set_path "/v1/audio/transcriptions";
    }
  }
  match api = "audio.translations" {
    upstream {
      set_path "/v1/audio/translations";
    }
  }
}
